CREATE DATABASE myDB
On Primary
( Name=myDB_data, -- Tên file logic 
FileName='D:\DB\myDB.mdf', -- Tên file vật lý
Size=50MB, -- Kích thước tập tin ban đầu
MaxSize= Unlimited, -- Kích thước tối đa
FileGrowth=10MB -- Kích thước tăng trưởng: 
),
FILEGROUP MyDB_FG1
 (NAME = 'MyDB_FG1_Dat1',
 FILENAME='D:\DB\MyDB_FG1_Dat1_01.ndf', 
 SIZE = 5MB,
 MAXSIZE=10MB,
 FILEGROWTH=1MB),
 (NAME = 'MyDB_FG1_Dat2',
 FILENAME ='D:\DB\MyDB_FG1_Dat1_01_02.ndf', 
 SIZE = 5MB,
 MAXSIZE=10MB,
 FILEGROWTH=10%)
 Log On
( Name=myDB_log,
FileName='D:\DB\myDB_log.ldf',
Size=50MB,
MaxSize=100MB,
FileGrowth=10MB
);

-- CAU 2
SELECT * FROM sys.filegroups;
SELECT * FROM sys.database_files;

-- CAU 3
ALTER DATABASE MyDB ADD FILEGROUP GroupFile_index;

ALTER DATABASE MyDB
ADD FILE (NAME = N'FILEGROUP_Index_01_01',
FILENAME = N'D:\DB\FILEGROUP_Index_01_01.ndf') TO FILEGROUP
GroupFile_index

-- CAU 4
create table KHACHHANG (
	MAKH int identity(1,1) primary key,
	TENKH nvarchar(100),
	SOCMND varchar(20),
	DIACHI nvarchar(100),
	TAIKHOAN varchar(50),
) on [primary]

create table temp(
	MAKH int,
	TENKH nvarchar(100),
	SOCMND varchar(20),
	DIACHI nvarchar(100),
	TAIKHOAN varchar(50),
) on [primary]
--CHÈN DỮ LIỆU TỪ FILE CSV VÀO BẢNG
BULK INSERT temp
FROM 'D:\MOCK_DATA.csv'
WITH (FORMAT = 'csv',
		FIELDTERMINATOR = ',',
		ROWTERMINATOR = '0x0a');

-- Tràn log
USE myDB;
go

ALTER DATABASE myDB
SET RECOVERY SIMPLE;
GO

--
DBCC SHRINKFILE(myDB_log, 50);
GO

--
ALTER DATABASE myDB
SET RECOVERY FULL;
GO

--
USE [master]
GO
ALTER DATABASE myDB ADD LOG FILE (NAME = N'NewLog', FILENAME = N'D:\DB\NewLog.idf')
go
--Tạo vòng lặp chạy 3.000.000 record từ 1.000 record
DECLARE @i int
set @i =1
while @i<3000
begin
BULK INSERT temp
	FROM 'D:\MOCK_DATA.csv'
	WITH(
		FIELDTERMINATOR=',',
		ROWTERMINATOR='0x0a'
	);
	set @i=@i+1
end
--
INSERT INTO KHACHHANG (TENKH, SOCMND, DIACHI, TAIKHOAN)
	SELECT TENKH, SOCMND, DIACHI, TAIKHOAN
	FROM temp



--Tạo index
CREATE INDEX idx_diachi ON KHACHHANG(DIACHI, TENKH);
DROP INDEX KHACHHANG.idx_diachi

--Xem thời gian thực thi
DECLARE @StartTime1 datetime
DECLARE @EndTime1 datetime
SELECT @StartTime1 = GETDATE()

--WRITE YOUR QUERY
SELECT * FROM KHACHHANG
WHERE DIACHI LIKE '79 Northridge Street'

SELECT @EndTime1 = GETDATE()

--This will return excecution time of your query
SELECT DATEDIFF(MS, @StartTime1, @EndTime1) AS [Duration in millisec]
--THời gian thực thi khác nhau nhanh nhất là 74s
--Tạo bảng chuyến bay
CREATE TABLE CHUYENBAY(
	MACB INT IDENTITY (1,1) PRIMARY KEY,
	NGAYBAY DATETIME,
	NOIDI NVARCHAR(100),
	NOIDEN NVARCHAR(100),
	SLGHEDAT INT,
	SLGHE INT,
	) ON [PRIMARY]

CREATE TABLE KHACHHANG_CHUYENBAY (
	MACB INT NOT NULL,
	MAKH INT NOT NULL,
	SOCMND VARCHAR(20),
	NGAYDC DATETIME,
	GHICHU NVARCHAR(100)

) ON [PRIMARY]

ALTER TABLE KHACHHANG_CHUYENBAY
ADD CONSTRAINT PK_MACB_MAKH
PRIMARY KEY(MACB, MAKH)

--Thêm thông tin chuyenbay
delete 
from CHUYENBAY
INSERT INTO CHUYENBAY VALUES ('2022/09/26',N'Sài Gòn', N'Hà Nội',23,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/27',N'Sài Gòn', N'Hà Nội',12,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/30',N'Sài Gòn', N'Hà Nội',31,50)
INSERT INTO CHUYENBAY VALUES ('2022/10/01',N'Sài Gòn', N'Hà Nội',10,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/02',N'Sài Gòn', N'Hà Nội',25,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/03',N'Sài Gòn', N'Hà Nội',31,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/04',N'Sài Gòn', N'Hà Nội',14,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/05',N'Sài Gòn', N'Hà Nội',42,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/06',N'Sài Gòn', N'Hà Nội',15,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/07',N'Sài Gòn', N'Hà Nội',10,50)

INSERT INTO CHUYENBAY VALUES ('2022/09/26',N'Hà Nội', N'Sài Gòn',21,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/27',N'Hà Nội', N'Sài Gòn',12,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/30',N'Hà Nội', N'Sài Gòn',21,50)
INSERT INTO CHUYENBAY VALUES ('2022/10/01',N'Hà Nội', N'Sài Gòn',13,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/02',N'Hà Nội', N'Sài Gòn',22,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/03',N'Hà Nội', N'Sài Gòn',16,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/04',N'Hà Nội', N'Sài Gòn',33,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/05',N'Hà Nội', N'Sài Gòn',41,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/06',N'Hà Nội', N'Sài Gòn',36,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/07',N'Hà Nội', N'Sài Gòn',27,50)

INSERT INTO CHUYENBAY VALUES ('2022/09/26',N'Hải Phòng', N'Sài Gòn',12,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/27',N'Hải Phòng', N'Sài Gòn',41,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/30',N'Hải Phòng', N'Sài Gòn',28,50)
INSERT INTO CHUYENBAY VALUES ('2022/10/01',N'Hải Phòng', N'Sài Gòn',31,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/02',N'Hải Phòng', N'Sài Gòn',23,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/03',N'Hải Phòng', N'Sài Gòn',11,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/04',N'Hải Phòng', N'Sài Gòn',13,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/05',N'Hải Phòng', N'Sài Gòn',14,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/06',N'Hải Phòng', N'Sài Gòn',31,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/07',N'Hải Phòng', N'Sài Gòn',14,50)

INSERT INTO CHUYENBAY VALUES ('2022/09/26',N'Sài Gòn', N'Hải Phòng',12,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/27',N'Sài Gòn', N'Hải Phòng',11,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/30',N'Sài Gòn', N'Hải Phòng',13,50)
INSERT INTO CHUYENBAY VALUES ('2022/10/01',N'Sài Gòn', N'Hải Phòng',34,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/02',N'Sài Gòn', N'Hải Phòng',14,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/03',N'Sài Gòn', N'Hải Phòng',31,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/04',N'Sài Gòn', N'Hải Phòng',23,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/05',N'Sài Gòn', N'Hải Phòng',14,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/06',N'Sài Gòn', N'Hải Phòng',34,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/07',N'Hải Phòng', N'Sài Gòn',14,50)


INSERT INTO CHUYENBAY VALUES ('2022/09/26',N'Sài Gòn', N'Hải Phòng',12,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/27',N'Sài Gòn', N'Hải Phòng',13,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/30',N'Sài Gòn', N'Hải Phòng',31,50)
INSERT INTO CHUYENBAY VALUES ('2022/10/01',N'Sài Gòn', N'Hải Phòng',23,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/02',N'Sài Gòn', N'Hải Phòng',41,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/03',N'Sài Gòn', N'Hải Phòng',21,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/04',N'Sài Gòn', N'Hải Phòng',31,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/05',N'Sài Gòn', N'Hải Phòng',40,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/06',N'Sài Gòn', N'Hải Phòng',23,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/07',N'Hải Phòng', N'Sài Gòn',14,50)

INSERT INTO CHUYENBAY VALUES ('2022/09/26',N'Buôn Mê Thuột', N'Hà Nội',13,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/27',N'Buôn Mê Thuột', N'Sài Gòn',21,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/30',N'Buôn Mê Thuột', N'Sài Gòn',18,50)
INSERT INTO CHUYENBAY VALUES ('2022/10/01',N'Buôn Mê Thuột', N'Sài Gòn',23,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/02',N'Buôn Mê Thuột', N'Sài Gòn',14,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/03',N'Buôn Mê Thuột', N'Sài Gòn',13,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/04',N'Buôn Mê Thuột', N'Sài Gòn',23,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/05',N'Buôn Mê Thuột', N'Sài Gòn',14,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/06',N'Buôn Mê Thuột', N'Sài Gòn',33,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/07',N'Buôn Mê Thuột', N'Sài Gòn',14,50)

INSERT INTO CHUYENBAY VALUES ('2022/09/26',N'Hà Nội',N'Buôn Mê Thuột',13,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/27',N'Sài Gòn',N'Buôn Mê Thuột',24,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/30',N'Sài Gòn',N'Buôn Mê Thuột',22,50)
INSERT INTO CHUYENBAY VALUES ('2022/10/01',N'Sài Gòn',N'Buôn Mê Thuột',13,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/02',N'Sài Gòn',N'Buôn Mê Thuột',24,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/03',N'Sài Gòn',N'Buôn Mê Thuột',18,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/04',N'Sài Gòn',N'Buôn Mê Thuột',23,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/05',N'Sài Gòn',N'Buôn Mê Thuột',14,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/06',N'Sài Gòn',N'Buôn Mê Thuột',33,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/07',N'Sài Gòn',N'Buôn Mê Thuột',24,50)

INSERT INTO CHUYENBAY VALUES ('2022/09/26',N'BangKok',N'Hà Nội',12,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/27',N'BangKok',N'Hà Nội',14,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/30',N'BangKok',N'Hà Nội',22,50)
INSERT INTO CHUYENBAY VALUES ('2022/10/01',N'BangKok',N'Hà Nội',23,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/02',N'BangKok',N'Hà Nội',34,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/03',N'BangKok',N'Hà Nội',31,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/04',N'BangKok',N'Hà Nội',13,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/05',N'BangKok',N'Hà Nội',24,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/06',N'BangKok',N'Hà Nội',33,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/07',N'BangKok',N'Hà Nội',14,50)


INSERT INTO CHUYENBAY VALUES ('2022/09/26',N'Singapore',N'Sài Gòn',13,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/27',N'Singapore',N'Sài Gòn',24,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/30',N'Singapore',N'Sài Gòn',31,50)
INSERT INTO CHUYENBAY VALUES ('2022/10/01',N'Singapore',N'Sài Gòn',13,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/02',N'Singapore',N'Sài Gòn',34,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/03',N'Singapore',N'Sài Gòn',12,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/04',N'Singapore',N'Sài Gòn',13,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/05',N'Singapore',N'Sài Gòn',24,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/06',N'Singapore',N'Sài Gòn',23,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/07',N'Singapore',N'Sài Gòn',24,50)

INSERT INTO CHUYENBAY VALUES ('2022/09/26',N'Sài Gòn',N'Singapore',13,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/27',N'Sài Gòn',N'Singapore',24,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/30',N'Sài Gòn',N'Singapore',31,50)
INSERT INTO CHUYENBAY VALUES ('2022/10/01',N'Sài Gòn',N'Singapore',23,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/02',N'Sài Gòn',N'Singapore',14,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/03',N'Sài Gòn',N'Singapore',11,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/04',N'Sài Gòn',N'Singapore',23,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/05',N'Sài Gòn',N'Singapore',14,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/06',N'Sài Gòn',N'Singapore',22,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/07',N'Sài Gòn',N'Singapore',14,50)

INSERT INTO CHUYENBAY VALUES ('2022/09/26',N'Vinh',N'Sài Gòn',23,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/27',N'Vinh',N'Sài Gòn',12,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/30',N'Vinh',N'Sài Gòn',11,50)
INSERT INTO CHUYENBAY VALUES ('2022/10/01',N'Vinh',N'Sài Gòn',13,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/02',N'Vinh',N'Sài Gòn',24,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/03',N'Vinh',N'Sài Gòn',12,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/04',N'Vinh',N'Sài Gòn',14,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/05',N'Vinh',N'Sài Gòn',23,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/06',N'Vinh',N'Sài Gòn',21,50)
INSERT INTO CHUYENBAY VALUES ('2022/09/07',N'Vinh',N'Sài Gòn',14,50)